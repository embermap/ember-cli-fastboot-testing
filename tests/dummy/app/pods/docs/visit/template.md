# Visit helper

The `visit` helper is the main API behind this addon. This function allows you to render a page generated by FastBoot into Ember's testing container.

```js
import { module, test } from 'qunit';
import { setup, visit } from 'ember-cli-fastboot-testing/test-support';

module('FastBoot | home-page test', function(hooks) {
  setup(hooks);

  test('it renders a page...', async function(assert) {
    await visit('/');

    // ...
  });

});
```

## Options

Visit can take an optional second parameter that lets you control the request sent to FastBoot. Many FastBoot applications will have conditional logic based on the incoming HTTP request. For example, you may want to render a different template based on the requesting browser's user agent.

### HTTP Headers

We can generate a FastBoot request with different HTTP headers using `visit`'s options.

```js
import { module, test } from 'qunit';
import { setup, visit } from 'ember-cli-fastboot-testing/test-support';

module('FastBoot | home-page test', function(hooks) {
  setup(hooks);

  test('it renders a page when given a specific user-agent', async function(assert) {
    await visit('/', {
      headers: {
        'user-agent': 'A crawling bot!'
      }
    });

    // ...
  });

});
```

The headers object can be configured with any HTTP header. You can change the hostname or set a logged in user cookie.

```js
await visit('/', {
  headers: {
    'cookie': 'user_id=12345;',
    'host': 'example.com'
  }
});
```

### Customizing App.visit

FastBoot's main entry point is its `App.visit` API. This method normally takes a URL and an options object that contains request and response data. However, heavily customized FastBoot applications will sometimes require additional data to be present in the options object.

FastBoot testing will pass through any options given to the visit helper when rendering pages in FastBoot. For example, here's how the following test code will translate to a FastBoot render.

```js
test('It can pass custom options to fastboot', async function(assert) {
  await visit('/', {
    meta: {
      version: '1.2.3'
    }
  });
});

// This will render FastBoot using the following

fastbootApp.visit('/', { meta: { version: '1.2.3' }});
```
